<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
 tex2jax: {
 inlineMath: [['$', '$'] ],
 displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
 }
 });
</script>

# classification / 分類問題

### 22140026 / 情報科学科

### Tomohiro Tani / 谷 知拓 / mail@taniii.com / https://taniii.com

### 2024.4.26

---

> カーネル法とは何か説明しなさい。また利点と欠点についてそれぞれ説明しなさい。カーネルトリックについて触れること。

`カーネル法` とは, そのままでは (ロジスティック回帰や SVM を用いて) 線形分離できない学習データについて, そのデータをより高次元に射影することで, 線形分離可能にする手法である.

ただし, 高次元に写像したベクトルどうしの内積を大量に計算するのは計算コストが高いので, `カーネルトリック` を用いる.  
`カーネルトリック` とは, 「射影 f により写像したのちに, ベクトルどうしの内積を計算する」代わりに, それらの合成関数を近似した `カーネル関数` を定義し, これを用いてカーネル法を実現する手法である.

> ランダムフォレスト、決定木、SVM の違いについてそれぞれ説明しなさい。

`ランダムフォレスト` とは, アンサンブル学習 (特に, バギング (Bootstrap Aggregation)) の 1 種であり, 訓練データを異なるランダムサブセットを用いて, 同一のアルゴリズムかつ複数インスタンスで学習し, 決定木を森のように成長させ, それらの多数決でクラスラベルを決める手法である. ランダム性がモデル全体のバリアンスを減少させるため, 過学習を抑制し, 安定したモデルを構築することが可能になる.

`決定木` とは, 木構造を使ってデータの特徴に基づく意思決定ルールをモデル化する, 分類/回帰タスクに用いられる手法である.  
数値データだけでなく, カテゴリカルデータもそのままで扱うことができるのが利点である.
一方で, 単体では, 過学習のリスクがあるため, ランダムフォレストなどを用いて安定したモデルにすることが重要である.

`SVM` (= サポートベクタマシン) は, クラス間の余白 (= マージン) を最大化することで, データを分類する手法である.  
高次元のデータでも効果的に扱うことができ, 適切な高次元に射影することにより, 非線形問題も, 線形問題に帰着させることができる.  
一方, 大規模データでは, 学習に時間がかかることや, 過学習を回避するために, 適切な次元 (カーネル) と, 正則化パラメータ (C) を選択することが重要である.

> カーネル SVM を用いた XOR データセットの分類において、SVM の二つのハイパーパラメータ（ガンマと C）を変えた場合、結果がどうなるか、以下の 4 パターンについてそれぞれ確認しなさい。(1) ガンマ大，C 小； (2) ガンマ大，C 大； (3) ガンマ小，C 小； (4) ガンマ小，C 大。
> また、なぜそのような結果になったのか考察しなさい。

### 結果

- (1) γ: 大, C: 小
  元より学習データに適合するようになり, 赤丸の `class 0` を覆うような決定境界になった.

- (2) γ: 大, C: 大
  (1) よりさらに学習データに適合するようになり, 青四角の `class 1` を覆うような決定境界になった.

- (3) γ: 小, C: 小
  学習データに適合しなくなり, 決定境界はシンプルになり, 学習データを正しく分類できなくなった.

- (4) γ: 小, C: 大
  元より学習データに適合しなくなり, 決定境界はシンプルになった. ただし, (3) よりは, 学習データに沿っている.

### 考察

γ が大きくなると, `カーネルの幅` が小さくなるので, 過剰にフィッティングしやすくなる.  
C が大きくなると, 正則化が弱くなり, 決定境界が複雑になるので, 過剰にフィッティングしやすくなる.

---

## notes.

- `ch02` の実行には `scikit-learn` が必要

```bash
pip install -U scikit-learn
```
