<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
 tex2jax: {
 inlineMath: [['$', '$'] ],
 displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
 }
 });
</script>

# regression analysis / 回帰分析

### 22140026 / 情報科学科

### Tomohiro Tani / 谷 知拓 / mail@taniii.com / https://taniii.com

### 2024.6.7

---

> 最小二乗線形回帰モデルについて説明しなさい。また、このモデルの問題について説明し、その問題を抑制する方法について説明しなさい。

最小二乗線形回帰モデル:
まず, 線形回帰モデルとは, 訓練データを通る直線のなかで最も適合する直線を探し, この回帰直線を予測に利用するモデルである. これを複数の説明変数について高次元に行うのが, 重線形回帰である. ここで, "最も適合する" 直線の重みを見つけ出すために, 平均二乗誤差を利用するのが, 最小二乗線形回帰モデルである.

このモデルの問題:
このモデルの問題の 1 つは, 訓練データの外れ値の影響を受けやすいことである.

問題を抑制する方法:
RANSAC を用いる方法がある. このアルゴリズムでは以下のような手順を踏むことにより, 外れ値による影響を軽減する.

1. ランダムに選択した点を 正常値 として用いて学習
2. そのモデルとその他の点とを比較して, 許容範囲 にあるデータ点を 正常値 に追加
3. すべての正常値を使って再学習
4. 正常値と訓練済みモデルの誤差を求める
5. 性能が十分なら終了 or 不十分なら 1 からやり直す

> 決定木回帰（最大深さ 3 と 10）の評価を以下の手順に従い行いなさい：まずデータセットを訓練とテストに 7:3 の割合で分割する。その後、訓練データ、テストデータそれぞれについて、MAE と決定係数を確認しなさい。最大深さ 3 の場合と 10 の場合で結果がどうなったか説明し、なぜそのような結果が得られたのか考察しなさい。

## 結果

- max_depth=3
  MAE train: 30140.17
  MAE test: 28695.00
  R^2 train: 0.73
  R^2 test: 0.74

- max_depth=10
  MAE train: 16726.21
  MAE test: 25298.13
  R^2 train: 0.85
  R^2 test: 0.77

## 考察

最大深さ 3 のとき, 訓練データに比べてテストデータの, MAE (平均絶対誤差) は低く, R^2 (決定係数; 説明変数が目的変数をどれくらい説明できるかを表す値) は高くなっている.  
これは, 比較的学習不足の傾向があることを示しているといえる.

最大深さ 10 のとき, 訓練データに比べてテストデータの, MAE (平均絶対誤差) は高く, R^2 (決定係数; 説明変数が目的変数をどれくらい説明できるかを表す値) は低くなっている.  
これは, 比較的過学習の傾向があることを示しているといえる.

---

## notes.
